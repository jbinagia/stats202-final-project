knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
install.packages(c("dplyr", "extrafont", "ggfortify", "ggrepel", "hexbin"))
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
summary(A_df['G14'])
summary(A_df['G14'])
names(A_df)
A_sub = A_df[ , -which(names(A_df) %in% c("PANSS_Total","LeadStatus"))]
summary(A_sub)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID",,"PANSS_Total","LeadStatus"))]
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","PANSS_Total","LeadStatus"))]
summary(A_sub)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","PANSS_Total","LeadStatus"))]
summary(A_sub)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","PANSS_Total","LeadStatus"))]
names(A_sub)
summary(A_sub)
A_scale = scale(A_sub)
summary(A_scale)
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
plot(A_scale, col =(km.out$cluster +1) , main="K-Means Clustering
Results with K=4", xlab ="", ylab="", pch =20, cex =2)
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
km.out
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # total within-cluster sum of squares
dim(A_sub)
dim(A_sub)
A_sub = subset(A_sub, VisitDay==0)
dim(A_sub)
knitr::opts_chunk$set(echo = TRUE)
#library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(ggfortify)
library(extrafont)
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
dim(A_sub)
A_sub = subset(A_sub, VisitDay==0)
dim(A_sub)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
names(A_sub)
#summary(A_sub)
A_scale = scale(A_sub)
#summary(A_scale)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
dim(A_df)
A_df = subset(A_df, VisitDay==0)
dim(A_df)
A_df = subset(A_df, VisitDay==0)
B_df = subset(B_df, VisitDay==0)
C_df = subset(C_df, VisitDay==0)
D_df = subset(D_df, VisitDay==0)
E_df = subset(E_df, VisitDay==0)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitGroup","PANSS_Total","LeadStatus"))]
names(A_sub)
A_df = subset(A_df, VisitDay==0)
B_df = subset(B_df, VisitDay==0)
C_df = subset(C_df, VisitDay==0)
D_df = subset(D_df, VisitDay==0)
E_df = subset(E_df, VisitDay==0)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
#summary(A_sub)
A_scale = scale(A_sub)
#summary(A_scale)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
set.seed(2)
km.out = kmeans(A_scale , 4, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(A_scale , 10, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(A_scale , 5, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
dim(A_sub)
combined = merge(A_sub,B_sub)
dim(combined)
dim(A_sub)
combined = rbind(A_sub,B_sub)
dim(combined)
dim(A_sub)
dim(B_sub)
combined = rbind(A_sub,B_sub)
dim(combined)
dim(A_sub)
dim(B_sub)
combined = rbind(A_sub,B_sub,C_sub,D_sub,E_sub)
dim(combined)
dim(A_sub)+dim(B_sub)
combined = rbind(A_sub,B_sub,C_sub,D_sub,E_sub)
dim(combined)
dim(A_sub)+dim(B_sub)+dim(C_sub)+dim(D_sub)+dim(E_sub)
combined = rbind(A_sub,B_sub,C_sub,D_sub,E_sub)
dim(combined)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
set.seed(2)
km.out = kmeans(scaled_df , 10, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
summary(scaled_df)
set.seed(2)
km.out = kmeans(scaled_df , 4, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 2, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 3, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 4, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 5, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 6, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 7, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 8, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(combined_df, 8, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
set.seed(2)
km.out = kmeans(scaled_df, 8, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
knitr::opts_chunk$set(echo = TRUE)
fviz_cluster(km.out, scaled_df,geom = c("point"))
knitr::opts_chunk$set(echo = TRUE)
#library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(ggfortify)
library(extrafont)
library(factoextra)
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
A_df = subset(A_df, VisitDay==0)
B_df = subset(B_df, VisitDay==0)
C_df = subset(C_df, VisitDay==0)
D_df = subset(D_df, VisitDay==0)
E_df = subset(E_df, VisitDay==0)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID","AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
summary(scaled_df)
set.seed(2)
km.out = kmeans(scaled_df, 8, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
km.out$size # cluster size
#km.out$centers # cluster means
fviz_cluster(km.out, scaled_df,geom = c("point"))
source('~/.active-rstudio-document', echo=TRUE)
# Use hcut() which compute hclust and cut the tree
hc.cut <- hcut(km.out, k = 3, hc_method = "complete")
# Use hcut() which compute hclust and cut the tree
hc.cut <- hcut(scaled_df, k = 3, hc_method = "complete")
# Visualize dendrogram
fviz_dend(hc.cut, show_labels = FALSE, rect = TRUE)
require(cluster)
pam.res <- pam(scaled_df, 3)
# Visualize pam clustering
fviz_cluster(pam.res, geom = "point", ellipse.type = "norm")
require(cluster)
# Use hcut() which compute hclust and cut the tree
hc.cut <- hcut(scaled_df, k = 3, hc_method = "complete")
# Visualize dendrogram
fviz_dend(hc.cut, show_labels = FALSE, rect = TRUE)
#require(cluster)
pam.res <- pam(scaled_df, 3)
# Visualize pam clustering
fviz_cluster(pam.res, geom = "point", ellipse.type = "norm")
fviz_cluster(km.out, scaled_df,geom = c("point"))
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
summary(scaled_df)
data("USArrests")
df = scale(USArrests)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
summary(scaled_df)
data("USArrests")
df = scale(USArrests)
summary(df)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
summary(df)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
summary(df)
names(USArrests)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
summary(df)
summary(USArrests)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
#summary(df)
summary(USArrests)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
#summary(df)
columns(df)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
#summary(df)
names(df)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
#summary(df)
names(USArrests)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
data("USArrests")
df = scale(USArrests)
#summary(df)
head(USArrests)
# Elbow method
fviz_nbclust(df, kmeans, method = "wss") +
geom_vline(xintercept = 4, linetype = 2)+
labs(subtitle = "Elbow method")
# Silhouette method
fviz_nbclust(df, kmeans, method = "silhouette")+
labs(subtitle = "Silhouette method")
# Gap statistic
# nboot = 50 to keep the function speedy.
# recommended value: nboot= 500 for your analysis.
# Use verbose = FALSE to hide computing progression.
set.seed(123)
fviz_nbclust(df, kmeans, nstart = 25,  method = "gap_stat", nboot = 50)+
labs(subtitle = "Gap statistic method")
# Elbow method
fviz_nbclust(scaled_df, kmeans, method = "wss") +
geom_vline(xintercept = 4, linetype = 2)+
labs(subtitle = "Elbow method")
# Silhouette method
fviz_nbclust(scaled_df, kmeans, method = "silhouette")+
labs(subtitle = "Silhouette method")
# Gap statistic
# nboot = 50 to keep the function speedy.
# recommended value: nboot= 500 for your analysis.
# Use verbose = FALSE to hide computing progression.
set.seed(1)
fviz_nbclust(scaled_df, kmeans, nstart = 25,  method = "gap_stat", nboot = 50)+
labs(subtitle = "Gap statistic method")
# Elbow method
fviz_nbclust(scaled_df, kmeans, method = "wss") +
geom_vline(xintercept = 4, linetype = 2)+
labs(subtitle = "Elbow method")
# Silhouette method
fviz_nbclust(scaled_df, kmeans, method = "silhouette")+
labs(subtitle = "Silhouette method")
# Gap statistic
# nboot = 50 to keep the function speedy.
# recommended value: nboot= 500 for your analysis.
# Use verbose = FALSE to hide computing progression.
#set.seed(1)
#fviz_nbclust(scaled_df, kmeans, nstart = 25,  method = "gap_stat", nboot = 50)+
#  labs(subtitle = "Gap statistic method")
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
#summary(scaled_df)
A_scale = scale(A_sub)
B_scale = scale(B_sub)
C_scale = scale(C_sub)
D_scale = scale(D_sub)
E_scale = scale(E_sub)
scaled_df = scale(combined_df)
summary(scaled_df)
set.seed(1)
km.out = kmeans(scaled_df, 10, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
km.out$size # cluster size
#km.out$centers # cluster means
fviz_cluster(km.out, scaled_df,geom = c("point"))
#require(cluster)
pam.res <- pam(scaled_df, 3)
# Visualize pam clustering
fviz_cluster(pam.res, geom = "point", ellipse.type = "norm")
#require(cluster)
pam.res <- pam(scaled_df, 10)
# Visualize pam clustering
fviz_cluster(pam.res, geom = "point", ellipse.type = "norm")
#require(cluster)
pam.res <- pam(scaled_df, 2)
# Visualize pam clustering
fviz_cluster(pam.res, geom = "point", ellipse.type = "norm")
fviz_cluster(km.out, scaled_df,geom = c("point"))
set.seed(1)
km.out = kmeans(scaled_df, 2, nstart =50)
km.clusters =km.out$cluster
km.out$tot.withinss # total within-cluster sum of squares
km.out$withinss # within-cluster sum of squares
km.out$size # cluster size
#km.out$centers # cluster means
fviz_cluster(km.out, scaled_df,geom = c("point"))
