scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#Plot total for each category vs Visit Day, for patients and control
A_sub_treated = A_sub[which(A_sub$TxGroup == "Treatment"),]
A_sub_control = A_sub[which(A_sub$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=A_sub_treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=A_sub_control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = A_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = B_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = C_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = D_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = E_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
knitr::opts_chunk$set(echo = TRUE)
#library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(ggsci)
library(forecast)
library(zoo)
library(extrafont)
#font_import()
#loadfonts(device = "win")
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#Plot PANSS_Total vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
moving_average_day=30
combined_df_treated$roll=rollmean(combined_df_treated$PANSS_Total,moving_average_day,na.pad=TRUE)
combined_df_control$roll=rollmean(combined_df_control$PANSS_Total,moving_average_day,na.pad=TRUE)
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
#geom_line(data=combined_df_treated,aes(x=VisitDay,y=roll,col="Treatment"))+
#geom_line(data=combined_df_control,aes(x=VisitDay,y=roll,col="Control"))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
#ggsave(plotname,p,width=6,height=6,units="in",dpi="retina")
print(p)
#Plot given PANSS score vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
i = 9
for (i in 9:38) {
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=combined_df_treated[,i],col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=combined_df_control[,i],col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
}
#Plot total for each category vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=totalP,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=totalP,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = E_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
head(E_sub)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
head(D_sub)
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
head(E_df)
summary(A_df)
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
head(E_sub)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("LeadStatus"))]
head(E_df)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df # study E does not have the LeadStatus column!
head(E_df)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df # study E does not have the LeadStatus column!
head(E_sub)
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
knitr::opts_chunk$set(echo = TRUE)
#library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(ggsci)
library(forecast)
library(zoo)
library(extrafont)
#font_import()
#loadfonts(device = "win")
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df # study E does not have the LeadStatus column!
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#Plot PANSS_Total vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
moving_average_day=30
combined_df_treated$roll=rollmean(combined_df_treated$PANSS_Total,moving_average_day,na.pad=TRUE)
combined_df_control$roll=rollmean(combined_df_control$PANSS_Total,moving_average_day,na.pad=TRUE)
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
#geom_line(data=combined_df_treated,aes(x=VisitDay,y=roll,col="Treatment"))+
#geom_line(data=combined_df_control,aes(x=VisitDay,y=roll,col="Control"))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
#ggsave(plotname,p,width=6,height=6,units="in",dpi="retina")
print(p)
#Plot given PANSS score vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
i = 9
for (i in 9:38) {
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=combined_df_treated[,i],col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=combined_df_control[,i],col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
}
#Plot total for each category vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=totalP,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=totalP,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = D_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#attach(combined_df)
lm.fit=lm(PANSS_Total~VisitDay+VisitDay:TxGroup, data=combined_df)
contrasts(combined_df$TxGroup) # display encoding for treatment
summary(lm.fit)
combined_df_zero = combined_df[which(combined_df$VisitDay==0),] # 0 day values for all patients
combined_df$deltaPANSS = combined_df$PANSS_Total
for (id in combined_df_zero$PatientID){
zeroValue = combined_df_zero[which(combined_df_zero$PatientID==id),]$PANSS_Total # integer zero value
combined_df[which(combined_df$PatientID==id),]$deltaPANSS =     combined_df[which(combined_df$PatientID==id),]$PANSS_Total - zeroValue # calculate difference from start to finish
}
#Plot PANSS_Total vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
moving_average_day=30
combined_df_treated$roll=rollmean(combined_df_treated$deltaPANSS,moving_average_day,na.pad=TRUE)
combined_df_control$roll=rollmean(combined_df_control$deltaPANSS,moving_average_day,na.pad=TRUE)
p=ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=deltaPANSS,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=deltaPANSS,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
#geom_line(data=combined_df_treated,aes(x=VisitDay,y=roll,col="Treatment"))+
#geom_line(data=combined_df_control,aes(x=VisitDay,y=roll,col="Control"))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#attach(combined_df)
lm.fit=lm(deltaPANSS~VisitDay+VisitDay:TxGroup)
knitr::opts_chunk$set(echo = TRUE)
#library(dplyr)
library(ggplot2)
library(hexbin)
library(RColorBrewer)
library(ggrepel)
library(extrafont)
library(ggfortify)
library(ggsci)
library(forecast)
library(zoo)
library(extrafont)
#font_import()
#loadfonts(device = "win")
A_df=read.csv("Data/Study_A.csv")
B_df=read.csv("Data/Study_B.csv")
C_df=read.csv("Data/Study_C.csv")
D_df=read.csv("Data/Study_D.csv")
E_df=read.csv("Data/Study_E.csv")
summary(A_df)
#remove LeadStatus column
A_sub = A_df[ , -which(names(A_df) %in% c("LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("LeadStatus"))]
E_sub = E_df # study E does not have the LeadStatus column!
combined_df = rbind(A_sub,B_sub,C_sub,D_sub,E_sub) # combine datasets
combined_df$totalP=rowSums(combined_df[,c("P1","P2","P3","P4","P5","P6","P7")])
combined_df$totalN=rowSums(combined_df[,c("N1","N2","N3","N4","N5","N6","N7")])
combined_df$totalG=rowSums(combined_df[,c("G1","G2","G3","G4","G5","G6","G7","G8","G9","G10","G11","G12","G13","G14","G15","G16")])
#Plot PANSS_Total vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
moving_average_day=30
combined_df_treated$roll=rollmean(combined_df_treated$PANSS_Total,moving_average_day,na.pad=TRUE)
combined_df_control$roll=rollmean(combined_df_control$PANSS_Total,moving_average_day,na.pad=TRUE)
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
#geom_line(data=combined_df_treated,aes(x=VisitDay,y=roll,col="Treatment"))+
#geom_line(data=combined_df_control,aes(x=VisitDay,y=roll,col="Control"))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
#ggsave(plotname,p,width=6,height=6,units="in",dpi="retina")
print(p)
#Plot given PANSS score vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
i = 9
#for (i in 9:38) {
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=combined_df_treated[,i],col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=combined_df_control[,i],col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#}
#Plot total for each category vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=totalP,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=totalP,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
study = D_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#attach(combined_df)
lm.fit=lm(PANSS_Total~VisitDay+VisitDay:TxGroup, data=combined_df)
contrasts(combined_df$TxGroup) # display encoding for treatment
summary(lm.fit)
combined_df_zero = combined_df[which(combined_df$VisitDay==0),] # 0 day values for all patients
combined_df$deltaPANSS = combined_df$PANSS_Total
for (id in combined_df_zero$PatientID){
zeroValue = combined_df_zero[which(combined_df_zero$PatientID==id),]$PANSS_Total # integer zero value
combined_df[which(combined_df$PatientID==id),]$deltaPANSS =     combined_df[which(combined_df$PatientID==id),]$PANSS_Total - zeroValue # calculate difference from start to finish
}
#Plot PANSS_Total vs Visit Day, for patients and control
combined_df_treated=combined_df[which(combined_df$TxGroup == "Treatment"),]
combined_df_control=combined_df[which(combined_df$TxGroup == "Control"),]
moving_average_day=30
combined_df_treated$roll=rollmean(combined_df_treated$deltaPANSS,moving_average_day,na.pad=TRUE)
combined_df_control$roll=rollmean(combined_df_control$deltaPANSS,moving_average_day,na.pad=TRUE)
p=ggplot(NULL,aes())+
geom_jitter(data=combined_df_treated,aes(x=VisitDay,y=deltaPANSS,col="Treatment"),size=0.5)+
geom_jitter(data=combined_df_control,aes(x=VisitDay,y=deltaPANSS,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
#geom_line(data=combined_df_treated,aes(x=VisitDay,y=roll,col="Treatment"))+
#geom_line(data=combined_df_control,aes(x=VisitDay,y=roll,col="Control"))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
#attach(combined_df)
lm.fit=lm(deltaPANSS~VisitDay+VisitDay:TxGroup)
study = E_sub
treated = study[which(study$TxGroup == "Treatment"),]
control = study[which(study$TxGroup == "Control"),]
p = ggplot(NULL,aes())+
geom_jitter(data=treated,aes(x=VisitDay,y=PANSS_Total,col="Treatment"),size=0.5)+
geom_jitter(data=control,aes(x=VisitDay,y=PANSS_Total,col="Control"),size=0.5)+
scale_color_manual(values=rev(pal_aaas("default")(2)))+
theme_minimal()+
theme(legend.title=element_blank(),plot.title=element_text(hjust=0.5,size=10,family="Lato"),plot.subtitle=element_text(hjust=0.5,size=8,family="Lato"),text=element_text(size=10,family="Lato"))
print(p)
knitr::opts_chunk$set(echo = TRUE)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
head(E_sub)
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
E_sub
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
D_sub
A_sub = A_df[ , -which(names(A_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
B_sub = B_df[ , -which(names(B_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
C_sub = C_df[ , -which(names(C_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
D_sub = D_df[ , -which(names(D_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
E_sub = E_df[ , -which(names(E_df) %in% c("Study","Country","PatientID","SiteID","RaterID",
"AssessmentiD","TxGroup","VisitDay","PANSS_Total","LeadStatus"))]
names(A_sub)
